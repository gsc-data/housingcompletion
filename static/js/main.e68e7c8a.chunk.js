(this.webpackJsonphousingcompletion=this.webpackJsonphousingcompletion||[]).push([[0],{124:function(e,t){},209:function(e,t,n){},234:function(e,t){},238:function(e,t,n){},240:function(e,t,n){"use strict";n.r(t);var r=n(5),a=n(51),i=n.n(a),c=n(14),o=(n.p,n(209),n(12)),s=n.n(o),l=n(21);var u=function(e,t){return t>e.length?null:function(e,t,n){var r=e.length-1,a=[],i=n;for(a[n]=e[e.length-1],a[0]=e[0];i>1;)a[i-1]=e[t[r][i]-2],r=t[r][i]-1,i--;return a}(e=e.slice().sort((function(e,t){return e-t})),function(e,t){var n,r,a=[],i=[],c=0;for(n=0;n<e.length+1;n++){var o=[],s=[];for(r=0;r<t+1;r++)o.push(0),s.push(0);a.push(o),i.push(s)}for(n=1;n<t+1;n++)for(a[1][n]=1,i[1][n]=0,r=2;r<e.length+1;r++)i[r][n]=1/0;for(var l=2;l<e.length+1;l++){for(var u=0,d=0,b=0,f=0,p=1;p<l+1;p++){var g=l-p+1,h=e[g-1];if(c=(d+=h*h)-(u+=h)*u/++b,0!==(f=g-1))for(r=2;r<t+1;r++)i[l][r]>=c+i[f][r-1]&&(a[l][r]=g,i[l][r]=c+i[f][r-1])}a[l][1]=1,i[l][1]=c}return{lower_class_limits:a,variance_combinations:i}}(e,t).lower_class_limits,t)},d=n(86),b=n(26),f=n(282),p=n(279),g=n(181),h=n.n(g),j=n(288),m=n(191),x=n(283),O=n(160),v=n(289),y=n(52),w=n(29);Object(d.d)({apiVersion:b.a.V2,username:"gsc-admin",apiKey:"default_public"});var S={latitude:-33.842104,longitude:150.998914,zoom:10,pitch:60,bearing:0};Object(d.d)({username:"gsc-admin",apiKey:"default_public"});new O.a;var _=[[225,83,131],[225,83,131],[241,109,122],[250,138,118],[255,166,121],[255,194,133],[255,221,154],[254,246,181]].reverse(),k=Object(j.a)().range(_),R=function(e){var t=e.start,n=e.end,a=Object(r.useState)([]),i=Object(c.a)(a,2),o=i[0],d=i[1],g=(Object(y.c)((function(e){return e.yearRange})),Object(y.c)((function(e){return e.domain}))),j=Object(y.b)(),O=Object(r.useState)(S),R=Object(c.a)(O,2),C=R[0],A=R[1],E="\n  select m.the_geom, m.mb_code16,sum(m.netcomplet) as dw  from housingcompletionsmbpoint as m \n  where m.time between ".concat(t," and ").concat(n," group by m.the_geom, m.mb_code16\n  ");Object(r.useEffect)((function(){(function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("https://gsc-admin.carto.com/api/v2/sql?q=".concat(encodeURIComponent(E),"&format=geojson"));case 2:return t=e.sent,d(t.data.features),n=u(t.data.features.map((function(e){return e.properties.dw})),_.length-2),j({type:"set_domain",domain:n}),console.log("hello"),e.abrupt("return",t);case 7:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}})()()}),[E]),k.domain(g);var F=new v.a({id:"hexagon-layer",data:o,pickable:!0,autoHighlight:!0,extruded:!0,radius:100,elevationScale:5,getPosition:function(e){return e.geometry.coordinates},getElevation:function(e){return e.properties.dw?e.properties.dw:0},getFillColor:function(e){return k(e.properties.dw)},getLineColor:function(e){return k(e.properties.dw)}}),I=new f.a({id:"district",type:b.f.QUERY,data:'select the_geom_webmercator, district from "gsc-admin".districtboundary ',getFillColor:[0,0,0,0],getLineColor:[211,211,211],lineWidthMinPixels:1,pickable:!1});return Object(w.jsx)("div",{children:Object(w.jsx)(x.a,{width:"100%",height:"100%",controller:!0,viewState:C,layers:[F,I],onViewStateChange:function(e){return A(e.viewState)},getTooltip:function(e){var t=e.object;return t&&"dwelling: ".concat(t.properties.dw)},children:Object(w.jsx)(m.a,{reuseMaps:!0,mapStyle:p.a.DARK_MATTER,mapboxApiAccessToken:"pk.eyJ1IjoiYnNuYXlhbiIsImEiOiJja3Ewczd3MW4wN3Z3MnVvNDNsenlzNnFsIn0.f8nk8yrxIeCKOlzIy1b-Pg",preventStyleDiffing:!0})})})},C=function(){var e=Object(y.c)((function(e){return e.domain}));return console.log(e),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{style:{height:"8px",width:"100%",display:"flex",flexDirection:"row"},children:_.slice(0,7).map((function(e){return Object(w.jsx)("div",{style:{flex:"0 0 14.28%",background:"rgb(".concat(e.join(),")")}})}))}),Object(w.jsx)("div",{style:{width:"100%",display:"flex",flexDirection:"row"},children:e.length&&e.map((function(e){return Object(w.jsx)("div",{style:{width:"14.28%",textAlign:"left",fontSize:"12px"},children:e})}))})]})},A=(n(238),n(280)),E=n(108),F=n(290),I=(n(286),n(189)),M=Object(A.a)((function(e){return{root:{width:280+2*e.spacing(3)},margin:{height:e.spacing(3)}}}));var z=Object(E.a)({root:{color:"#ff9999",height:8},thumb:{height:24,width:24,backgroundColor:"#fff",border:"2px solid currentColor",marginTop:-8,marginLeft:-12,"&:focus, &:hover, &$active":{boxShadow:"inherit"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{height:8,borderRadius:4},rail:{height:8,borderRadius:4}})(F.a);function D(){var e=M(),t=Object(y.c)((function(e){return e.yearRange})),n=Object(y.b)(),a=Object(r.useCallback)(Object(I.debounce)((function(e,t){return n({type:"set_year",yearRange:t})}),2e3),[]);return Object(w.jsx)("div",{className:e.root,children:Object(w.jsx)(z,{valueLabelDisplay:"auto","aria-label":"distance slider",defaultValue:t,min:2e3,max:2020,onChange:function(e,t){return a(e,t)}})})}var N=n(145),T=n(195),L=function(e){var t=Object(r.useState)("idle"),n=Object(c.a)(t,2),a=n[0],i=n[1],o=Object(r.useState)([]),u=Object(c.a)(o,2),d=u[0],b=u[1];return Object(r.useEffect)((function(){e&&function(){var t=Object(l.a)(s.a.mark((function t(){var n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i("fetching"),t.next=3,fetch("https://gsc-admin.carto.com/api/v2/sql?q=".concat(encodeURIComponent(e)));case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,b(r.rows.sort((function(e,t){return e.district>t.district?1:-1}))),i("fetched");case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[e]),{status:a,data:d}};N.b.register(T.a),N.b.defaults.color="#FFFFFF";var P={indexAxis:"y",maintainAspectRatio:!1,elements:{bar:{borderWidth:1}},responsive:!0,scales:{x:{ticks:{callback:function(e,t,n){return e/1e3+"k"}}},yAxes:{ticks:{font:{weight:function(e){return"Greater Sydney"===e.tick.label?"bold":"normal"}}}}},plugins:{datalabels:{formatter:function(e,t){return Math.round(e/1e3,0)+"k"},anchor:"end",align:"start",font:{size:"12px",weight:"bold"},color:function(e){var t=e.dataset.backgroundColor,n=t.slice(5,t.length-5).split(",").map((function(e){return parseInt(e)})),r=Object(c.a)(n,3),a=r[0],i=r[1],o=r[2];"rgb(".concat(Math.round(.5*a,0),",").concat(Math.round(.5*i,0),",").concat(Math.round(.5*o,0),")");return"rgba(255,255,255)"}},legend:{display:!1}}},V=function(e){var t=e.start,n=e.end,r='\n  select t.district, sum(t.netcomplet) dw from  (SELECT a.mb_code16,a.netcomplet,a.time,b.district FROM "gsc-admin".housingcompletionsmbpoint a inner join  "gsc-admin"."mb_lga_int" b on a.mb_code16=b.mb_code16 where a.time between '.concat(t," and ").concat(n,") t group by t.district\n  "),a=L(r),i=(a.status,a.data),c={labels:i.map((function(e){return e.district})),datasets:[{label:"",data:i.map((function(e){return e.dw})),backgroundColor:"rgba(255, 145, 164,200)",borderColor:"rgba(255, 145, 164,255)",borderWidth:1}]};return Object(w.jsx)("div",{style:{height:"400px"},children:Object(w.jsx)(N.a,{data:c,options:P})})},q=function(e,t){return String(e).padStart(t,"0")},J=function(){var e=Object(y.c)((function(e){return e.yearRange})),t=Object(c.a)(e,2),n=t[0],r=t[1];Object(y.b)();return Object(w.jsxs)("div",{className:"layer-selector",style:{fontFamily:"Roboto, sans-serif",textAlign:"left"},children:[Object(w.jsxs)("b",{children:["  Dwelling completion between FY ",n,"-",q(parseInt(String(n).slice(-2))+1,2)," and ",r,"-",q(parseInt(String(r).slice(-2))+1,2)]}),Object(w.jsx)(D,{}),Object(w.jsx)("h4",{style:{textAlign:"left",margin:"0px 0px 3px 0px"},children:"LEGEND"}),Object(w.jsx)(C,{}),Object(w.jsx)("div",{style:{marginTop:"10px",marginBottom:"10px",fontSize:"small"},children:Object(w.jsx)("b",{children:"Total dwelling completion by distict"})}),Object(w.jsx)(V,{start:n,end:r}),Object(w.jsx)("div",{children:Object(w.jsx)("span",{style:{fontSize:"8px",textAlign:"left"},children:"Source: GSC Analysis 2021,DPIE"})}),Object(w.jsxs)("span",{style:{fontSize:"10px",lineHeight:"1.1em",textAlign:"left"},children:["Please contact ",Object(w.jsx)("a",{href:"mailto: data@gsc.nsw.gov.au",children:"data@gsc.nsw.gov.au"})," for more info"]})]})};var K=function(){var e=Object(y.c)((function(e){return e.yearRange})),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)(R,{start:n,end:r}),Object(w.jsx)(J,{})]})},W=n(197),Y=n(2),G={yearRange:[2011,2020],domain:[1,45,171,401,821,1565,3468]};var U=Object(W.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"set_year":return Object(Y.a)(Object(Y.a)({},e),{},{yearRange:t.yearRange});case"set_domain":return Object(Y.a)(Object(Y.a)({},e),{},{domain:t.domain});default:return e}}));i.a.render(Object(w.jsx)(y.a,{store:U,children:Object(w.jsx)(K,{})}),document.getElementById("root"))}},[[240,1,2]]]);
//# sourceMappingURL=main.e68e7c8a.chunk.js.map